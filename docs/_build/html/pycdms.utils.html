

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pycdms.utils package &mdash; pycdms 0.2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pycdms.plotting package" href="pycdms.plotting.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pycdms
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pycdms.html">pycdms package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pycdms.detcal.html">pycdms.detcal package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pycdms.fitting.html">pycdms.fitting package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pycdms.plotting.html">pycdms.plotting package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">pycdms.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pycdms.utils.utils">pycdms.utils.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pycdms.utils">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pycdms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="pycdms.html">pycdms package</a> &raquo;</li>
        
      <li>pycdms.utils package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pycdms.utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pycdms-utils-package">
<h1>pycdms.utils package<a class="headerlink" href="#pycdms-utils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pycdms.utils.utils">
<span id="pycdms-utils-utils-module"></span><h2>pycdms.utils.utils module<a class="headerlink" href="#module-pycdms.utils.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pycdms.utils.utils.align_traces">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">align_traces</code><span class="sig-paren">(</span><em>traces</em>, <em>lgcjustshifts=False</em>, <em>n_cut=5000</em>, <em>cut_off_freq=5000.0</em>, <em>fs=625000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.align_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to align dIdV traces if each trace does not trigger at the same point. Uses
a convolution of the traces to find the time offset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traces</strong> : ndarray</p>
<blockquote>
<div><blockquote>
<div><p>Array of shape (# traces, # bins per trace).</p>
</div></blockquote>
<dl class="docutils">
<dt>lgcjustshifts <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first last">If False, the aligned traces and the phase shifts are returned. 
If True, just the phase shifts are returned.</p>
</dd>
<dt>n_cut: int. The number of bins to use to do the convolution</dt>
<dd><p class="first last">Just need enough information to see the periodic signal</p>
</dd>
</dl>
<p>cut_off_freq: float or int, 3dB frequency for filter
fs: float or int, sample rate of DAQ, defaults to 625e3</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>shifts</strong> : ndarray</p>
<blockquote class="last">
<div><blockquote>
<div><p>Array of phase shifts for each trace in units of bins.</p>
</div></blockquote>
<dl class="docutils">
<dt>masked_aligned <span class="classifier-delimiter">:</span> <span class="classifier">masked ndarray, optional</span></dt>
<dd><p class="first last">Array of time shift corrected traces, same shape as input traces.
The masked array masks the np.NaN values in the time shifted traces so that
normal numpy functions will ignore the nan’s in computations.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycdms.utils.utils.calc_offset">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">calc_offset</code><span class="sig-paren">(</span><em>x</em>, <em>fs=1.0</em>, <em>sgfreq=100.0</em>, <em>is_didv=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.calc_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the DC offset of time series trace.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : ndarray</p>
<blockquote>
<div><blockquote>
<div><p>Array to calculate offsets of.</p>
</div></blockquote>
<dl class="docutils">
<dt>fs <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Sample rate of the data being taken, assumed to be in units of Hz.</p>
</dd>
<dt>sgfreq <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">The frequency of signal generator (if is_didv is True. If False, then this is ignored).</p>
</dd>
<dt>is_didv <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If False, average of full trace is returned. If True, then the average of
n Periods is returned (where n is the max number of full periods present in a trace).</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>offset</strong> : ndarray</p>
<blockquote class="last">
<div><blockquote>
<div><p>Array of offsets with same shape as input x minus the last dimension</p>
</div></blockquote>
<dl class="docutils">
<dt>std <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Array of std with same shape as offset</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycdms.utils.utils.calc_psd">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">calc_psd</code><span class="sig-paren">(</span><em>x</em>, <em>fs=1.0</em>, <em>folded_over=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.calc_psd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the PSD of an n-dimensional array, assuming that we want the PSD of the last axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array_like</p>
<blockquote>
<div><blockquote>
<div><p>Array to calculate PSD of.</p>
</div></blockquote>
<dl class="docutils">
<dt>fs <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Sample rate of the data being taken, assumed to be in units of Hz.</p>
</dd>
<dt>folded_over <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">Boolean value specifying whether or not the PSD should be folded over. 
If True, then the symmetric values of the PSD are multiplied by two, and
we keep only the positive frequencies. If False, then the entire PSD is 
saved, including positive and negative frequencies. Default is to fold
over the PSD.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>f</strong> : ndarray</p>
<blockquote class="last">
<div><blockquote>
<div><p>Array of sample frequencies</p>
</div></blockquote>
<dl class="docutils">
<dt>psd <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Power spectral density of ‘x’</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycdms.utils.utils.fill_negatives">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">fill_negatives</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.fill_negatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple helper function to remove negative and zero values from psd’s.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>arr</strong> : ndarray</p>
<blockquote>
<div><p>1d array</p>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>——-</strong></p>
<blockquote class="last">
<div><dl class="docutils">
<dt>arr <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">arr with the negative and zero values replaced by interpolated values</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycdms.utils.utils.iterstat">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">iterstat</code><span class="sig-paren">(</span><em>data</em>, <em>cut=3</em>, <em>precision=1000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.iterstat" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to iteratively remove outliers based on how many standard deviations they are from the mean,
where the mean and standard deviation are recalculated after each cut.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : ndarray</p>
<blockquote>
<div><blockquote>
<div><p>Array of data that we want to remove outliers from</p>
</div></blockquote>
<dl class="docutils">
<dt>cut <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Number of standard deviations from the mean to be used for outlier rejection</p>
</dd>
<dt>precision <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Threshold for change in mean or standard deviation such that we stop iterating. The threshold is 
determined by np.std(data)/precision. This means that a higher number for precision means a lower
threshold (i.e. more iterations).</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>datamean</strong> : float</p>
<blockquote class="last">
<div><blockquote>
<div><p>Mean of the data after outliers have been removed.</p>
</div></blockquote>
<dl class="docutils">
<dt>datastd <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Standard deviation of the data after outliers have been removed</p>
</dd>
<dt>datamask <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Boolean array indicating which values to keep or reject in data, same length as data.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycdms.utils.utils.load_noise">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">load_noise</code><span class="sig-paren">(</span><em>file_str</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.load_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Load noise object that has been previously saved as pickle file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>file_str</strong> : str</p>
<blockquote>
<div><p>The full path to the file to be loaded.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>f</strong> : Object</p>
<blockquote class="last">
<div><p>The loaded noise object.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycdms.utils.utils.lowpassfilter">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">lowpassfilter</code><span class="sig-paren">(</span><em>traces</em>, <em>cut_off_freq=100000</em>, <em>fs=625000.0</em>, <em>order=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.lowpassfilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a low pass filter to the inputted time series traces</p>
</dd></dl>

<dl class="function">
<dt id="pycdms.utils.utils.removeoutliers">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">removeoutliers</code><span class="sig-paren">(</span><em>x</em>, <em>maxiter=20</em>, <em>skewTarget=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.removeoutliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to return indices of inlying points, removing points by minimizing the skewness</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : ndarray</p>
<blockquote>
<div><blockquote>
<div><p>Array of real-valued variables from which to remove outliers.</p>
</div></blockquote>
<dl class="docutils">
<dt>maxiter <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Maximum number of iterations to continue to minimize skewness. Default is 20.</p>
</dd>
<dt>skewTarget <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Desired residual skewness of distribution. Default is 0.05.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">inds :</p>
<blockquote class="last">
<div><p>Boolean indices indicating which values to select/reject, same length as x.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycdms.utils.utils.stdcomplex">
<code class="descclassname">pycdms.utils.utils.</code><code class="descname">stdcomplex</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pycdms.utils.utils.stdcomplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to return complex standard deviation (individually computed for real and imaginary 
components) for an array of complex values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : ndarray</p>
<blockquote>
<div><blockquote>
<div><p>An array of complex values from which we want the complex standard deviation.</p>
</div></blockquote>
<dl class="docutils">
<dt>axis <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Which axis to take the standard deviation of (should be used if the 
dimension of the array is greater than 1)</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>std_complex</strong> : ndarray</p>
<blockquote class="last">
<div><p>The complex standard deviation of the inputted array, along the specified axis.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pycdms.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pycdms.utils" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="pycdms.plotting.html" class="btn btn-neutral" title="pycdms.plotting package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Caleb Fink, Sam Watkins.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>